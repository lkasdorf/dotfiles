function ctxtaaswanapi(g){var d,k,h,a,c,p,q,l,f;d=function(){g&&g.isTracingEnabled&&window.console&&window.console.log&&"function"===typeof window.console.log&&window.console.log.apply(window.console,arguments)};k=function(){return g&&g.rootUrl?g.rootUrl:"https://cis.citrite.net/doppler"};p=function(){d("Creating XMLHttpRequest.");if(0<f.length)return f.pop();var a;if(window.XMLHttpRequest)if(a=new window.XMLHttpRequest,void 0===a.withCredentials)d('XMLHttpRequest does not support "withCredentials".');
else if(void 0===a.onload)d('XMLHttpRequest does not support "onload".');else if(void 0===a.onerror)d('XMLHttpRequest does not support "onerror".');else if(void 0===a.status)d('XMLHttpRequest does not support "status".');else if(void 0===a.statusText)d('XMLHttpRequest does not support "statusText".');else if(void 0===a.responseText)d('XMLHttpRequest does not support "responseText".');else return a};q=function(a,e){d("Getting document with ID = "+a);if(!a)throw Error("ID must be provided.");if(!e)throw Error("done must be provided.");
var b;b=p();b.onload=function(){d("getDoc is complete, status = "+b.statusText);f.push(b);if(200!==b.status)e();else{var a;try{a=JSON.parse(b.response)}catch(v){d("getDoc could not parse response into an object.")}e(a)}};b.onerror=function(){d("getDoc errored.");e()};b.ontimeout=function(){d("getDoc timedout.");e()};b.open("GET",k()+"?id="+a);b.send()};l=function(a,e){d("Finding documents.");if(!a)throw Error("operators must be provided.");if(1>a.length)throw Error("operators must not be empty.");
var b;b=p();b.onload=function(){d("findDocs is complete, status = "+b.statusText);f.push(b);if(200!==b.status)e();else{var a;try{a=JSON.parse(b.response)}catch(v){d("findDocs could not parse response into an object.")}e(a)}};b.onerror=function(){d("findDocs errored.");e()};b.ontimeout=function(){d("findDocs timedout.");e()};b.open("GET",k()+"/find?"+h(a));b.send()};h=function(f){d("Building operators string.");var e,b;b="";for(e=0;e<f.length;e+=1)b+=(0===e?"":"&")+a(f[e],e);return b};a=function(a,
f){d("Building operator string.");var b;b="n-"+f+"="+a.name;a.bucket&&(b+="&b-"+f+"="+a.bucket);a.parameters&&0<a.parameters.length&&(b+="&"+c(a.parameters,f));return b};c=function(a,f){d("Building parameters string.");var b,c;c="";for(b=0;b<a.length;b+=1)c+=(0===b?"":"&")+"p-"+f+"-"+b+"="+a[b];return c};d("Initializing ctxtaaswaniapi.");f=[];f.push(p());return f[0]?JSON?{wanApi:{postDoc:function(a,e){d("Posting new document.");if(!a)throw Error("doc must be provided.");if("object"!==typeof a&&"string"!==
typeof a)throw Error("doc must be either object or a string");var b;b=p();b.onload=function(){d("postDoc is complete, status = "+b.statusText);f.push(b)};b.onerror=function(){d("postDoc errored.")};b.ontimeout=function(){d("postDoc timedout.")};b.open("POST",k(),!e);b.setRequestHeader("content-type","application/json");b.send("object"===typeof a?JSON.stringify(a):a)},getDoc:q,getSingle:function(a,f){d("Finding and getting a single document.");l(a,function(a){var c;if(a){for(c in a)if(a.hasOwnProperty(c)){q(c,
f);return}d("getSingle received no document IDs.")}else d("getSingle found no matching documents.");f()})},findDocs:l}}:(d("JSON is not supported."),{wanApi:{}}):(d("CORS XMLHttpRequest is not supported."),{wanApi:{}})}
function ctxtaaswancap(g,d){if(!g)throw Error('Parameter "sink" must be set.');var k,h,a,c,p,q,l;k=function(){d&&d.isTracingEnabled&&window.console&&window.console.log&&"function"===typeof window.console.log&&window.console.log.apply(window.console,arguments)};h=function(a){var c;c=a.getBoundingClientRect();a=a.parentElement.getBoundingClientRect();return c.left<a.left-1||c.right>a.right+1||c.top<a.top-1||c.bottom>a.bottom+1};a=function(a,c){var e;for(e=document.elementFromPoint(a,c);;){if(!e)return null;
if(e.id||e===document.body)return e;if(!e.parentElement||h(e))return null;e=e.parentElement}};c=function(a,c,e){a=a.getBoundingClientRect();c<a.left?c=a.left:c>a.right&&(c=a.right);e<a.top?e=a.top:e>a.bottom&&(e=a.bottom);return{x:Math.floor(10*(c-a.left)/(a.right-a.left+1)),y:Math.floor(10*(e-a.top)/(a.bottom-a.top+1))}};p=function(f){var d;f=f||window.event;(d=a(f.clientX,f.clientY))?(f=c(d,f.clientX,f.clientY),l=d===document.body?{x:f.x,y:f.y}:{id:d.id,x:f.x,y:f.y}):(k("Click outside document."),
l=null)};q=function(a){l&&(l.id?g.clickBody&&g.clickElement(l.id,l.x,l.y):g.clickElement&&g.clickBody(l.x,l.y))};k("Initializing ctxtaaswancap.");window.addEventListener?(window.addEventListener("mousedown",p,!0),window.addEventListener("click",q,!0)):(window.attachEvent("onmousedown",p),window.attachEvent("onclick",q))}
function ctxtaaswanrec(g,d,k,h){if(!g)throw Error('Parameter "api" must be set.');if(!d)throw Error('Parameter "appId" must be set.');if(!k)throw Error('Parameter "appVersion" must be set.');var a,c,p,q,l,f,v,e,b,r,n,m,t,w,C,x,z,y,A,u,B="ctxtaaswan_".concat(d),s;a=function(){h&&h.isTracingEnabled&&window.console&&window.console.log&&"function"===typeof window.console.log&&window.console.log.apply(window.console,arguments)};t=function(){return h&&h.sessionExpirationInterval?h.sessionExpirationInterval:
9E5};w=function(){return 1E5};C=function(){return 3145728};c=function(a){if(!(a instanceof Array))throw Error("Cache entry is not an instance of Array");if(!a[0])throw Error("cache entry index 0 (interface name) must be set.");if(!(a[1]&&a[1]instanceof Date))throw Error("cache entry index 1 must set to Date object");if(!(a[2]&&a[2]instanceof Array))throw Error("cache entry index 2 is not an instance of Array");var b;if(b=v[a[0]])a[2].push(a[1]),b.apply(null,Array.prototype.slice.apply(a[2]))};p=function(a){return!("string"!==
typeof a||0===a.length)};q=function(a){return!!("number"===typeof a&&0===a%1&&0<=a&&9>=a)};f=function(a){if(null===a||void 0===a)a=new Date;else if(!(a instanceof Date))throw Error("input date must be Date Object");return a.toISOString()};l=function(){return window.navigator.language||window.navigator.browserLanguage};e=function(b,c){a("Adding setPage event, id = "+b);b&&p(b)||(a("id is undefined, null or empty"),b="");u("setPage",c,{id:b})};b=function(b,c,e,d){a("Adding clickElement event, id = "+
b+", x = "+c+", y = "+e);if(!b||!p(b))throw Error("id is undefined, null or empty");if(!q(c))throw Error("x is not valid virtual coordinate");if(!q(e))throw Error("y is not valid virtual coordinate");u("clickElement",d,{id:b,x:c,y:e})};r=function(b,c,e){a("Adding clickBody event, x = "+b+", y = "+c);if(!q(b))throw Error("x is not valid virtual coordinate");if(!q(c))throw Error("y is not valid virtual coordinate");u("clickBody",e,{x:b,y:c})};n=function(b,c,e,d){a("Adding scriptError event, src = "+
b+", line = "+c+", col = "+e);u("scriptError",d,{src:b,line:c,col:e})};m=function(b,c){a("Adding custom event, ev = "+b);u("custom",c,{ev:b})};x=function(){s={type:"taasWanSession",appId:d,appVersion:k,userAgent:window.navigator.userAgent,language:l(),events:[]}};z=function(){0===s.events.length?a("No need to save empty session."):h&&h.uploadOnUnload?(a("Uploading session."),g.postDoc(s,!0)):window.localStorage?window.localStorage.setItem(B,JSON.stringify(s)):a("Cannot save session - localStorage API is not available.")};
y=function(){a("Checking whether session is expired.");if(0===s.events.length)a("Session has no events.");else{var b;b=A(s);0>=b?(a("Session expired."),g.postDoc(s),x()):(a("Session has not expired."),window.setTimeout(y,b))}};A=function(a){return t()+(new Date(a.events[a.events.length-1].received)).getTime()-(new Date).getTime()};u=function(b,c,e){b=s.events.push({type:b,received:f(c),data:e});b>=w()?(a("Session has too many events."),g.postDoc(s),x()):1===b&&window.setTimeout(y,t())};if(!g.postDoc)return a("API does not support postDoc method."),
{};if(!JSON)return a("JSON API is not available."),{};a("Initializing ctxtaaswanrec.");v={setPage:e,clickElement:b,clickBody:r,scriptError:n,custom:m};(function(){a("Initializing session.");x();if(window.localStorage){var b,c,e;b=window.localStorage.getItem(B);window.localStorage.removeItem(B);b?b.length>=C()?(a("Serialized session date exceed the maximum length, start new session."),g.postDoc(b)):(c=JSON.parse(b),c.appVersion!==k?(a("Saved session was for the old version of the application, upload and start new session."),
g.postDoc(b)):0<c.events.length&&(e=A(c),0>=e?(a("Saved session expired, upload and start new session."),g.postDoc(b)):(s=c,window.setTimeout(y,e)))):a("Existing session is not found, start new session.")}else a("localStorage API is not supported, use in-memory session.")})();h&&h.cache&&0<h.cache.length&&(a("Cache is not empty, process cache data."),h.cache.forEach(c));h&&h.isDataLost&&a("Some data was lost.");window.addEventListener?window.addEventListener("unload",z,!1):window.attachEvent("unload",
z);return{recorder:{setPage:function(a){e(a,null)},clickElement:function(a,c,e){b(a,c,e,null)},clickBody:function(a,b){r(a,b,null)},scriptError:function(a,b,c){n(a,b,c,null)},custom:function(a){m(a,null)}}}}
(function(g){function d(a,c,d,h,l,f){var k,e,b,r,n,m;k=function(a){var b;n?(b=n[a])&&b.apply(n,Array.prototype.slice.call(arguments,1)):r.length<h?r.push([a,new Date,Array.prototype.slice.call(arguments,1)]):m=!0};e=function(a){if(window[a])b();else{var c;c=document.createElement("script");c.type="text/javascript";c.async=!0;c.addEventListener?c.addEventListener("load",b,!1):c.readyState&&(c.onreadystatechange=function(){"complete"!==c.readyState&&"loaded"!==c.readyState||b()});c.src=d+"/js/"+a+".js";
a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(c,a)}};b=function(){var b;!n&&window.ctxtaaswancap&&window.ctxtaaswanrec&&window.ctxtaaswanapi&&(b=window.ctxtaaswanapi({isTracingEnabled:l,rootUrl:d}).wanApi)&&(n=window.ctxtaaswanrec(b,a,c,{cache:r,isDataLost:m,isTracingEnabled:l,sessionExpirationInterval:f}).recorder)&&(window.ctxtaaswancap(n,{isTracingEnabled:l}),r=null)};r=[];g(window).on("error",function(a){a&&k("scriptError",a.filename,a.lineno,"number"===typeof a.colno?
a.colno:a.column)});e("ctxtaaswancap");e("ctxtaaswanrec");e("ctxtaaswanapi");return k}function k(a){var c=0,d;for(d=0;d<a.length;d++)var g=a.charCodeAt(d),c=((c<<7)+g)%99999989;return"v1-"+c}var h;window.CTXS=window.CTXS||{};CTXS.Analytics={_currentPage:null,_section:"none",startGlobal:function(){"global"!=this._section&&("post-global"==this._section?this._section="global":(this._section="global",h("setPage","_global")))},endGlobal:function(){"global"==this._section&&(this._currentPage?(this._section=
"page",this.setPage(this._currentPage)):this._section="post-global")},load:function(a){h=d(a.appId,a.appVersion,a.wanURL,Number(a.cacheLength)||1E3,a.isTracingEnabled,Number(a.sessionExpirationInterval)||3E4)},setPage:function(a){this._currentPage=a;"global"!=this._section&&(this._section="page",h("setPage",a))},custom:function(a){try{h("custom",a)}catch(c){CTXS.trace("ERROR in analytics#6 "+c)}}};CTXS.ExtensionAPI.addPlugin({name:"analytics",initialize:function(){var a=this;g.fn.origCtxsDisplayPane=
g.fn.ctxsDisplayPane;g.fn.ctxsDisplayPane=function(){var c=this.attr("id"),d=this.origCtxsDisplayPane();"home-screen"==c&&(c=a._getCurrentHomeScreenView());c&&CTXS.Analytics.setPage(c);return d};g(".securitydetailslink").hover(function(){CTXS.Analytics.custom({"Security details read":!0})});g(".licenseagreement-link").hover(function(){CTXS.Analytics.custom({"License agreement read":!0})});CTXS.Analytics.load({appId:"receiverWebUi",appVersion:"FrontDoor",wanURL:"https://cis.citrix.com/doppler",cacheLength:1E3,
isTracingEnabled:!1,sessionExpirationInterval:3E4});this._sendInitialInfo()},_sendInitialInfo:function(){try{CTXS.Analytics.startGlobal(),CTXS.Analytics.custom({"Screen Resolution":(screen?screen.width:0)+"x"+(screen?screen.height:0)}),CTXS.Analytics.custom({Platform:CTXS.Device.getPlatform()}),CTXS.Analytics.custom({"High Resolution":CTXS.Device.supportsHighResDisplay()}),CTXS.Analytics.custom({Orientation:CTXS.Device.getOrientation()}),CTXS.Analytics.custom({"HTML5 Client Configuration":CTXS.Config.getConfigValue("pluginAssistant.html5.enabled")}),
CTXS.Analytics.custom({"HTML5 Client Mandatory":CTXS.Html5Client.isMandatory()}),CTXS.Analytics.custom({"HTML5 Client Optional":CTXS.Html5Client.isAvailable()&&!CTXS.Html5Client.isMandatory()}),CTXS.Analytics.custom({"Plugin Assistant enabled":"true"===CTXS.Config.getConfigValue("pluginAssistant.enabled")}),CTXS.Analytics.custom({"Show Plugin Assistant after login":"true"===CTXS.Config.getConfigValue("pluginAssistant.showAfterLogin")}),CTXS.Analytics.custom({"Show Plugin Assistant only if required by apps":"true"===
CTXS.Config.getConfigValue("pluginAssistant.showOnlyIfRequiredByApps")}),CTXS.Analytics.custom({"Protocol Handler enabled":CTXS.Device.isProtocolHandlerEnabled()}),CTXS.Analytics.custom({"Protocol Handler supported":CTXS.Device.isProtocolHandlerSupported()}),CTXS.Analytics.custom({"Show Activate Receiver only if required by apps":"true"===CTXS.Config.getConfigValue("userInterface.receiverConfiguration.showOnlyIfRequiredByApps")}),CTXS.Analytics.custom({ServerHash:k(window.location.origin)}),CTXS.Analytics.custom({SiteHash:k(window.location.pathname)}),
CTXS.Analytics.endGlobal()}catch(a){CTXS.trace("ERROR in analytics#1 "+a)}},noteNativeClient:function(a){try{CTXS.Analytics.startGlobal(),a&&a.platform&&(CTXS.Analytics.custom({"Native id":a.platform.id}),CTXS.Analytics.custom({"Native app":a.platform.appname}),CTXS.Analytics.custom({"Native version":a.platform.appversion}),CTXS.Analytics.custom({"Native culture":a.platform.appculture}),CTXS.Analytics.endGlobal())}catch(c){CTXS.trace("ERROR in analytics#4 "+c)}this.chain("noteNativeClient",arguments)},
noteNativeStore:function(a){try{CTXS.Analytics.startGlobal(),props&&props.platform&&CTXS.Analytics.custom({"Native store":k(a.baseUrl)}),CTXS.Analytics.endGlobal()}catch(c){CTXS.trace("ERROR in analytics#5 "+c)}this.chain("noteNativeStore",arguments)},beforeDisplayHomeScreen:function(a){!CTXS.Device.isNativeClient()&&CTXS.Authentication.currentAuthMethod&&CTXS.Analytics.custom({"Authentication Method":CTXS.Authentication.currentAuthMethod});this.chain("beforeDisplayHomeScreen",arguments)},preProcessAppData:function(a,
c){try{CTXS.Analytics.startGlobal();var d;d="isSubscriptionEnabled"in c?c.isSubscriptionEnabled?"true":"false":"undefined";CTXS.Analytics.custom({"Is Anonymous User":c.isUnauthenticatedStore?"true":"false"});CTXS.Analytics.custom({"Subscription Status OK":d});try{CTXS.Analytics.custom({"Number of Featured App Groups":c.bundles?c.bundles.length:0})}catch(g){CTXS.trace("ERROR in analytics#2 "+g)}CTXS.Analytics.custom({"Number of Resources":c.resources.length});for(var h=d=0,f=[],k=0,e=0,b=0,r=0;r<c.resources.length;r++){var n=
c.resources[r];if(n){var m=n.path;if(m){"\\"==m[0]&&(m=m.substring(1));"\\"==m[m.length-1]&&(m=m.substring(0,m.length-1));var t=(m.match(/\\/g)||[]).length+1;t>d&&(d=t);f[m]||(f[m]="used",h++)}n.isdesktop&&k++;"subscribed"==n.subscriptionstatus&&e++;CTXS.Environment.includeAppInStore(n)||b++}}CTXS.Analytics.custom({"Number of subscribed resources":e});CTXS.Analytics.custom({"Number of desktops":k});CTXS.Analytics.custom({"Number of resources excluded from store UI":b});CTXS.Analytics.custom({"Number of categories":h});
CTXS.Analytics.custom({"Max Category Depth":d});CTXS.Analytics.endGlobal()}catch(w){CTXS.trace("ERROR in analytics#3 "+w)}this.chain("preProcessAppData",arguments)},doLaunch:function(a,c,d){CTXS.Analytics.custom({"Launch Client Type":a.clienttypes&&0<a.clienttypes.length?a.clienttypes[0]:"unknown"});CTXS.Analytics.custom({"Launch Method":CTXS.ClientManager.getLaunchMethod()});this.chain("doLaunch",arguments)},doSubscribe:function(){CTXS.Analytics.custom({"App subscribed":!0});this.chain("doSubscribe",
arguments)},doRemove:function(){CTXS.Analytics.custom({"App removed":!0});this.chain("doRemove",arguments)},doInstall:function(){CTXS.Analytics.custom({"App installed":!0});this.chain("doInstall",arguments)},lastView:null,lastFolderDepth:-1,postRedraw:function(){try{this._registerViewChange()}catch(a){CTXS.trace("error in redraw analytics "+a)}this.chain("postRedraw",arguments)},_registerViewChange:function(){var a=this._getCurrentHomeScreenView();a&&a!=this.lastView&&(CTXS.Analytics.setPage(a),this.lastView=
a);"folder"==a&&(a=g(".breadcrumb-contents li").length,a!=this.lastFolderDepth&&(CTXS.Analytics.custom({"Current Folder Depth":a}),this.lastFolderDepth=a))},_getCurrentHomeScreenView:function(){var a=CTXS.currentView;"store"==a&&(a=g(".store-toolbar .selected"),a=a.hasClass("allapps-view")?"allapps":a.hasClass("folder-view")?"folder":g(".store-toolbar .search-container").hasClass("with-text")?"search":0<g(".breadcrumb-contents li").length?"folder":null);return a}})})(jQuery);
